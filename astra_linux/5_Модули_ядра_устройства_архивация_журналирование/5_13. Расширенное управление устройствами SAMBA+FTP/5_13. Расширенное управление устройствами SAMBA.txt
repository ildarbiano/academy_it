План урока:
SMB/CIFS
Конфигурационный файл smb.conf
Настройки директорий
Работа с расшаренными папками
NFS
Ftp-сервер
Анонимный режим работы VSFTP
Практическое задание

========================= SMB/CIFS ====================================================================================
SMB		Server Message Block
CIFS 		Common Internet File System	 
SMB/CIFS	это протокол, использующийся для обмена файлами между компьютерами, работающими в сети. 
Samba		в linux для работы с протоколом SMB/CIFS используется пакет Samba, который является реализацией протокола SMB/CIFS для операционных систем Linux и других UNIX-подобных систем.
sudo apt update
sudo apt upgrade -y				Обновление установленных пакетов до последних версий
sudo apt-get install samba			Установка и настройка Samba в Linux. 
sudo useradd -M -s /usr/sbin/nologin <username>		Добавление пользователя Samba.	
sudo groupadd <users_group>				Добавление группы пользователей Samba.
sudo usermod -aG <users_group> <username>		Добавление пользователя в группу Samba.
sudo smbpasswd -a <username>				Добавление пользователя Samba.
sudo mkdir -p /DATA/samba/{public,private}			Создаём директории public и private, которые будут нашими хранилищами.
sudo chmod -R 0775 /DATA/samba/					Навешиваем права на директорию 
sudo chown nobody:nogroup /DATA/samba/public			Навешиваем права на директорию public
sudo chown <username>:<users_group>  /DATA/samba/private	Навешиваем права на директории private.
sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.backup     	Настройка файла smb.conf. Делаем бекап файла настроек
sudo nano /etc/samba/smb.conf       				Открываем файл smb.conf. Стираем все строки и вставляем следующее:
	[global]					global – секция отвечает за общие настройки Samba-сервера;
		workgroup = WORKGROUP			workgroup – рабочая группа. Для упрощения работы пользователей WORKGROUP указывается, как группа по умолчанию. Если в вашей сети имя рабочей группы изменено, то следует изменить это значение и для Samba; 
		security = user				security – уровень безопасности сервера. Значение user означает авторизацию по паре логин/пароль;
		map to guest = bad user			map to guest – параметр определяет способ обработки запросов. Значение bad user означает, что запросы с неправильным паролем будут отклонены, даже если такое имя пользователя существует; 
		wins support = no			wins support – включить или выключить поддержку WINS;
		dns proxy = no				dns proxy – возможность проксирования запросов к DNS. 
	[public]                  			public – секции описания настроек директорий общего доступа. Имя сетевого ресурса.
		path = /DATA/samba/public; 		path – полный путь до директории на жестком диске. Путь к расшаренной директории.
		guest ok = yes				guest ok – возможность доступа к каталогу без пароля (гостевой).
		force user = nobody			force user – пользователь от которого ведется работа с каталогом. Для повышения безопасности сервера, обычно используют nobody. Главное, не использовать пользователя root – это небезопасно.
		force group = nogroup
		browsable = yes				browsable – показывать ли каталог (“шару”) на сервере среди прочих. Если параметр установлен как “no”, то доступ будет возможен по полному пути, например ip-addresshidden_directory.
		readonly = no
	[private]					private – секции описания настроек директорий общего доступа.
		path = /DATA/samba/private
		valid users = @<users_group>		valid users – список пользователей у которых есть доступ к каталогу. Если пользователей несколько, их имена указываются через запятую. Если необходим доступ для пользователей принадлежащих группе, перед именем группы устанавливается символ ”at” @ (“собака”).
		guest ok = no
		browsable = yes
		writable = yes				writable – установка значения как “yes” позволяет пользователю выполнять действия над файлами внутри каталога – переименование, добавление, удаление, перемещение в подкаталог и копирование;
------- ! Важно! Имя директории общего доступа, отображаемое пользователям, равно имени секции в которой оно описано.
		----------------------------------------------------------------------------------------------------
sudo testparm -s					Проверяем конфигурацию сервера Samba.
	Load smb config files from /etc/samba/smb.conf
	Loaded services file OK.
	Server role: ROLE_STANDALONE
	# Global parameters
	[global]
		dns proxy = No
		map to guest = Bad User
		security = USER
		idmap config * : backend = tdb
	[public]
		force user = nobody
		guest ok = Yes
		path = /DATA/samba/public
		read only = No
	[private]
		path = /DATA/samba/private
		read only = No
		valid users = @<users_group>
		----------------------------
sudo systemctl restart smbd.service nmbd.service	После настройки файла smb.conf необходимо перезапустить Samba. 
/DATA/samba/{public,private}				Файлообменный сервер настроен и готов к работе в директориями /DATA/samba/{public,private} с других компьютеров, находящихся в той же локальной сети.


========================= Конфигурационный файл smb.conf ================================================================================
Конфигурационный файл smb.conf, который мы создали, состоит из трех секций:
[global] 		отвечает за общие настройки Samba-сервера. В секции global присутствуют пять параметров.
	workgroup  	Рабочая группа. Для упрощения работы пользователей WORKGROUP указывается как группа по умолчанию. Если в вашей сети имя рабочей группы изменено, то следует изменить это значение и для Samba.
	security  	Уровень безопасности сервера. Значение user означает авторизацию по паре логин/пароль.
	map to guest   	Параметр определяет способ обработки запросов. Значение bad user означает, что запросы с неправильным паролем будут отклонены, даже если такое имя пользователя существует.
	wins support 	Включить или выключить поддержку WINS
	dns proxy   	Возможность проксирования запросов к DNS.
[public]		секция описания настроек директорий общего доступа
[private] 		секция описания настроек директорий общего доступ  


========================= Настройки директорий ==========================================================================================
Настройки директорий выполняются в соответствующих секциях:
path			полный путь до директории на жестком диске.
guest ok		возможность доступа к каталогу без пароля (гостевой).
browsable		показывать ли каталог (“шару”) на сервере среди прочих.  Если параметр установлен как “no”, то доступ будет возможен по полному пути, например ip-addresshidden_directory.
force user 		пользователь, от которого ведётся работа с каталогом.  Для повышения безопасности сервера обычно используют nobody.  Главное, не использовать пользователя root – это небезопасно.
writable		установка значения “yes” позволяет пользователю выполнять действия над файлами внутри каталога – переименование, добавление, удаление, перемещение в подкаталог и копирование.
valid users		список пользователей, у которых есть доступ к каталогу.  Если пользователей несколько, их имена указываются через запятую.  Если необходим доступ для пользователей, принадлежащих группе, перед именем группы устанавливается символ ”at” @ (“собака”).
Имя директории общего доступа, отображаемое пользователям, равно имени секции, в которой оно описано.

======================== Работа с расшаренными папками ====================================================================================
		Как только Samba запущена, можно приступать к работе с расшаренными папками из других компьютеров, работающих в той же локальной сети.
Для подключения к расшаренной папке в Linux в графическом интерфейсе, необходимо выполнить следующие действия: 
- Открыть файловый менеджер. 
- Выбрать "Сеть". 
- Выбрать имя компьютера, на котором запущена Samba. 
- Если требуются авторизационные данные, ввести имя пользователя и пароль, созданные при настройке. 
sudo mount.cifs.		- для подключения к расшаренной папке в Linux через командную строку можно использовать команду 
sudo mount -t cifs //<server>/<share_name> <mount_point> -o users,sec=none
	<server> 		- имя или IP-адрес сервера, на котором запущена Samba 
	<share_name> 		- имя расшаренной папки (имя блока, которое мы задавали в 3 пункте)
	<mount_point>		- путь к папке, куда будет произведено монтирование ресурса 
	users			— любые пользователи
sudo mount.cifs //192.168.0.10/public /mnt/shared -o users,sec=none	для подключения к расшаренной папке с именем "public" на сервере с IP-адресом 192.168.0.10 и монтирования ее в папку "/mnt/shared", команда. после выполнения этой команды папка "public будет доступна в папке "/mnt/shared".
sudo umount /mnt/shared							если требуется отмонтировать этот ресурс, можно воспользоваться командой umount:	
/etc/fstab								чтобы расшаренная папка монтировалась автоматически, нужно внести соответствующую запись в файл "/etc/fstab". Для этого необходимо добавить следующую строку в файл "/etc/fstab":
//<server>/<share>  <mount_point>  cifs credentials=/root/.smbclient,rw,nosharesock,vers=1.0,soft,noperm 0 0
	Где:
	<server> 		- имя или IP-адрес сервера, на котором запущена Samba 
	<share> 		- имя расшаренной папки 
	<mount_point>	 	- путь к папке, куда будет произведено монтирование ресурса 
	credentials 		- Имя файла, содержащего логин и пароль samba для автоматического монтирования. Формат файла:
	username=samba_user_name
	password=samba_user_password
	domain=astra.ru		- Параметр domain можно не указывать, если доменное имя не используется.
	rw 			- Разрешение на чтение и на запись.
	nosharesock 		- Принудительное создание на сервере нового отдельного сокета (позволяет создать несколько независимых точек монтирования для разных пользователей).
	soft 			- При отказе сервера программы, работающие с примонтированными ресурсами, не зависают, а возвращают ошибку. Это режим по умолчанию.
	vers 			- Выбор версии протокола SMB. По умолчанию используется версия 1.0.
	noperm			- Клиент не выполняет проверку прав доступа. Это позволяет предоставить доступ к файловым объектам этой точки монтирования другим локальным пользователям клиентской системы.
После сохранения файла "/etc/fstab" система будет автоматически монтировать расшаренную папку при каждом запуске. 
sudo apt-get install cifs-utils	- !!! для использования автоматического монтирования через файл "/etc/fstab" необходимо установить пакет "cifs-utils":
Таким образом, настройка и управление Samba в Linux позволяет удобно обмениваться файлами между компьютерами в локальной сети. С помощью Samba можно создавать расшаренные папки, управлять правами доступа, а также настраивать другие параметры для обеспечения комфортной и безопасной работы.
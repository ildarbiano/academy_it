Мандатное управление доступом	
https://wiki.astralinux.ru/pages/viewpage.action?pageId=153486002

План урока
Уровни и категории конфиденциальности.
Метка безопасности.
Дополнительные мандатные атрибуты.
Установка меток и дополнительных атрибутов безопасности на файлы и каталоги.
Практическое задание.


====================== Уровни и категории конфиденциальности МКД и МКЦ ==========================================================================
Уровни и категории конфиденциальности обеспечивают безопасность информации. Классические уровни конфиденциальности:
	«несекретно» 			(НС)		несекретно (0),
	«для служебного использования»	(ДСП)		для служебного пользования (1), персоналу с уровнем доступа ДСП разрешено читать только документы уровней ДСП и «несекретно»
	«секретно» 			(С)		секретно (2), персоналу с уровнем конфиденциальности «секретно» запрещено передавать персоналу с более низким уровнем доступа ДСП документы уровня «секретно»
	«совершенно секретно» 		(СС)		совершенно секретно (3). максимальный уровень доступа — 3.
Мандатный контроль доступом		(МКД)	доступ к данным. Для более точного управления доступом в дополнение к разделению по уровням конфиденциальности Astra Linux позволяет разделить материалы по категориям конфиденциальности. Возьмём две условные категории: «Танки» и «Самолёты». Персонал, работающий с танками и имеющий соответствующую категорию конфиденциальности, не сможет получать сведения о самолётах и передавать сведения о танках тем, кто работает с самолётами. Однако условному руководителю могут быть предоставлены одновременно обе категории конфиденциальности, чтобы он получал полный объём информации.
Мандатный контроль целостности		(МКЦ)	гарантирует неизменность данных. Уровень целостности отвечает за сохранность и изменение информации, то есть за безопасность самой информационной системы. Система мандатного управления доступом работает со следующими понятиями:
Субъекты мандатного доступа 		(пользователь, процесс) — те, кто выполняет операции, подлежащие мандатному контролю. Субъект, работающий на некотором уровне целостности, может записывать (изменять) только сущности (объекты) своего или более низкого уровня. Изменять объекты более высокого уровня запрещено.
Сущности 				(объекты) мандатного доступа (файл, каталог и т. п.) — то, с чем выполняются операции, подлежащие мандатному контролю.
Мандатный контекст 			структура, включающая в себя атрибуты управления доступом субъектов к объектам. Он включает в себя метку безопасности и дополнительные мандатные атрибуты.



====================== Метка безопасности ======================================================================================================
Метка безопасности включает в себя две метки: классификационную метку и метку целостности. 
Классификационная метка			состоит из иерархического уровня конфиденциальности и неиерархической категории конфиденциальности. 
Метка целостности 			представлена одним мандатным атрибутом — неиерархическим уровнем целостности.
см. скрин "Метки безопасности"
В виде записи метка безопасности выглядит так:
	3:63:0хffffffffffffffff
3:			<Уровень безопасности> - Иерархический уровень конфиденциальности. Единичное числовое значение НС, ДСП, С, СС (0,1,2,3). 
:63:			<Уровень целостности> - Не-иерархический уровень целостности — уровень целостности — в первую очередь отвечает за безопасность самой информационной системы; во вторую — за то, чтобы информацию не могли изменять те, кому не положено её изменять. Маска: числа от 0 до 63.
:0			<Категории> - Иерархическая категория конфиденциальности отвечают за то, чтобы информация не попадала к тому, кто не уполномочен её получать.. Маска....
х			разделительный символ для 8-миричной, 16-тиричной
ffffffffffffffff	количество символов определяющие систему (группа, к которой принадлежит пользователь)

====================== Дополнительные мандатные атрибуты =======================================================================================
В зависимости от реализации формальной модели управления доступом отдельные пользователи получают набор необязательных мандатных атрибутов управления доступом, не входящих в метку. Необязательные мандатные атрибуты управления доступом позволяют уточнять правила мандатного доступа для отдельных пользователей или каталогов и файлов. В Astra Linux есть следующие дополнительные мандатные атрибуты управления доступом:
CCNRA			Container Clearance Negative Required. это псевдоним для сочетания флагов ccnr и ccnri. Мандатный атрибут, который позволяет хранить в каталогах объекты с различными метками конфиденциальности, но не выше, чем собственная метка родительского каталога.
ccnr			мандатный атрибут метки безопасности каталогов файловой системы. Определяет, что каталог содержит файлы с различными классификационными метками не больше его собственной метки.  
ccnr			мандатный атрибут метки безопасности каталогов файловой системы. Пользователь может читать содержимое такого каталога вне зависимости от значения классификационной метки этого пользователя.
ccnr			мандатный атрибут метки безопасности каталогов файловой системы. Пользователю доступна информация только о находящихся в этом каталоге файлах с классификационной меткой не больше собственной классификационной метки пользователя, либо о каталогах, имеющих мандатный атрибут управления доступом ccnr.
ccnri			мандатный атрибут метки безопасности каталогов файловой системы. Определяет, что каталог может содержать файлы с различными уровнями целостности, но не большими, чем его собственный уровень целостности. Применяется только к каталогам.
ccnr 			— может присваиваться только контейнерам, определяет, что контейнер может содержать сущности с различными классификационными метками, но не большими, чем его собственная метка.
irelax			мандатный атрибут метки безопасности каталогов файловой системы. Определяет, что создавать файлы в каталоге может пользователь с любой меткой целостности. Если метка целостности пользователя меньше или равна метке целостности каталога, создаваемые в каталоге файлы наследуют метку целостности создающего их пользователя. Если метка целостности пользователя выше или несравнима с меткой целостности каталога, метка целостности создаваемых файлов устанавливается как наибольшее значение, одновременно меньшее или равное значениям меток целостности каталога и пользователя.
ehole			мандатный атрибут метки безопасности файлов. Присваивается файлам, имеющим минимальную метку безопасности. Его наличие приводит к игнорированию мандатных правил управления доступом к файлам. Этот атрибут предназначен для файлов, из которых пользователи не могут прочитать данные, записанные в них пользователями с более высокой классификационной меткой, чем их собственная (например, /dev/null).
ehole 			- может присваиваться сущностям (файлам), не являющимся контейнерами и имеющим минимальную классификационную метку, игнорирует мандатные правила управления доступом к ним.
whole			мандатный атрибут метки безопасности файлов. Присваивается файлам c максимальной классификационной меткой и разрешает запись в них пользователям, имеющим более низкую классификационную метку, тогда как в обычном случае писать «снизу вверх» запрещено.
whole 			- присваивается сущностям (файлам), не являющимся контейнерами, с максимальной классификационной меткой, разрешает запись в них субъектам, имеющим более низкую классификационную метку.
PARSEC			мандатный атрибут — привилегии. Они предоставляют права выполнения определённых административных действий. Полный перечень привилегий и предоставляемых ими прав определяется реализацией формальной модели управления доступом.  Сюда входят привилегии PARSEC.
PARSEC 			привилегия наследуют процессы своих «родителей». Это процессы, запущенные от имени суперпользователя, имеющего максимальный (высокий) уровень целостности по умолчанию. Пользователи с привилегиями PARSEC осуществляют большинство привилегированных действий.


===================== Установка меток и дополнительных атрибутов безопасности на файлы и каталоги ==============================================
pdpl-file [ОПЦИИ]... [УРОВЕНЬ][:УРОВЕНЬ_ЦЕЛОСТНОСТИ[:КАТЕГОРИЯ[:ФЛАГИ]]] ФАЙЛ...		чтобы установить метки и дополнительные атрибуты безопасности.
УРОВЕНЬ			задаются именем или десятичным значением.
УРОВЕНЬ_ЦЕЛОСТНОСТИ 	задаются именем или десятичным значением.
КАТЕГОРИЯ 		задаётся именем или шестнадцатеричным значением.
ФЛАГИ 			задаются значением или именами через запятую:
ФЛАГИ	для директорий: 	ccnr, ccnri. Можно использовать алиас CCNRA (ccnr,ccnri);
ФЛАГИ	для файлов: 		ehole (с минимальной меткой) или whole (с максимальной меткой).
sudo pdp-ls [КЛЮЧ]... [ФАЙЛ]…		для просмотра установленных меток и дополнительных атрибутов безопасности.
sudo pdp-ls –help			для получения справки о применении и ключах команды pdp-ls введите команду.
Изменяет мандатные свойства файла на УРОВЕНЬ, УРОВЕНЬ_ЦЕЛОСТНОСТИ, КАТЕГОРИЮ и ФЛАГИ.
-f, 			--silent, --quiet не выводить сообщения об ошибках;
-v, 			--verbose выводить диагностические сообщения для каждого файла;
-c, 			--changes то же, что и --verbose, но сообщает только об изменениях;
-u, 			--unite объединить текущую метку файла с заданной в качестве аргумента;
-s, 			--subtract вычесть из текущей метки файла заданную в качестве аргумента;
-R, 			--recursive применить рекурсивно;
-r, 			--reverse сначала файлы в директории, потом — директорию;
-h, 			--help вывести эту справку и выйти;
--version 		вывести информацию о версии и выйти.
см. скрин "pdpl описание команды"
pdpl-file 1:0:0:0 /mydir0			- изменяет мандатные атрибуты файлов, включая мандатную метку и специальные мандатные атрибуты файла


===================== Установка меток и дополнительных атрибутов безопасности для пользователя ==============================================
pdpl-user -i 63 {имя_пользователя} 		- задает максимальный уровень целостности (63) для пользователя.

